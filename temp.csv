Layer Name,FLOPS,InputA,InputB,Output
pre_attn_norm,57344,"1,7168,1",,"1,7168,1"
query_down,44040192,"1,7168,1","7168,1536,1","1,1536,1"
k_rope_w,1835008,"1,7168,1","7168,64,1","64,1026,1"
kv_down,14680064,"1,7168,1","7168,512,1","1026,512,1"
norm_for_compressed_q,12288,"1,1536,1",,"1,1536,1"
norm_for_compressed_kv,4096,"1026,512,1",,"1026,512,1"
q_rope_w,50331648,"1,1536,1","1536,8192,1","128,64,1"
query_up,100663296,"1,1536,1","1536,16384,1","1,16384,1"
transposed (k up proj),33554432,"1,16384,1","512,16384,1","1,512,128"
q_rope,98304,"128,64,1",,"128,64,1"
k_rope,768,"64,1026,1",,"64,1026,1"
score layer for RoPE,33603584,"128,64,1","64,1026,1","128,1026,1"
score layer for NoPE,268828672,"1,512,128","1026,512,1","1,1026,128"
mask_scale_softmax,1837696,"128,1026,1",,"128,1026,1"
context_matmul,268828672,"128,1026,1","1026,512,1","1,512,128"
v_up_proj_context,33554432,"1,512,128","512,16384,1","1,128,128"
out_proj_context,469762048,"1,128,128","16384,7168,1","1,7168,1"
residual_addition,14336,"1,7168,1",,"1,7168,1"
post_attn_norm,57344,"1,7168,1",,"1,7168,1"
gate_shared,58720256,"1,7168,1","7168,2048,1","1,2048,1"
up_shared,58720256,"1,7168,1","7168,2048,1","1,2048,1"
silu_shared,28672,"1,2048,1",,"1,2048,1"
down_shared,58720256,"1,2048,1","2048,7168,1","1,7168,1"
router,7340032,"1,7168,1","7168,256,1","1,256,1"
gate_routed,58720256,"1,7168,1","7168,2048,1","1,2048,1"
up_routed,58720256,"1,7168,1","7168,2048,1","1,2048,1"
silu_routed,28672,"1,2048,1",,"1,2048,1"
down_routed,58720256,"1,2048,1","2048,7168,1","1,7168,1"
residual_addition2,14336,"1,7168,1",,"1,7168,1"
Total FLOPS,1681497472,,,
