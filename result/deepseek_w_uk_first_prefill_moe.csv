Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time
pre_attn_norm,29360128,14680064,,14680064,29360128,1.0,8.758988066825776
query_down,22548578304,14680064,22020096,3145728,22548578304,565.8947368421053,22.790153935718617
k_rope_w,939524096,14680064,917504,131072,939524096,59.733333333333334,4.692315035799523
kv_down,7516192768,14680064,7340032,1048576,7516192768,325.8181818181818,7.5967179785728725
norm_for_compressed_q,6291456,3145728,,3145728,6291456,1.0,1.8769260143198092
norm_for_compressed_kv,2097152,1048576,,1048576,2097152,1.0,0.6256420047732697
q_rope_w,25769803776,3145728,25165824,16777216,25769803776,571.5348837209302,26.045890212249848
query_up,51539607552,3145728,50331648,33554432,51539607552,592.1927710843373,52.091780424499696
transposed (k up proj),17179869184,33554432,16777216,134217728,17179869184,93.0909090909091,55.056496420047736
q_rope,50331648,16777216,,16777216,50331648,1.5,10.010272076372315
k_rope,393216,131072,,131072,393216,1.5,0.07820525059665871
score layer for RoPE,17179869184,16777216,131072,268435456,17179869184,60.2076251722554,85.12641527446301
score layer for NoPE,137438953472,134217728,1048576,268435456,137438953472,340.44675324675325,138.91141446533254
mask_scale_softmax,939524096,268435456,,268435456,939524096,1.75,160.16435322195704
context_matmul,137438953472,268435456,1048576,134217728,137438953472,340.44675324675325,138.91141446533254
v_up_proj_context,17179869184,134217728,16777216,33554432,17179869184,93.0909090909091,55.056496420047736
out_proj_context,240518168576,33554432,234881024,14680064,240518168576,849.5407407407407,243.09497531433192
residual_addition,7340032,14680064,,14680064,7340032,0.25,8.758988066825776
post_attn_norm,29360128,14680064,,14680064,29360128,1.0,8.758988066825776
gate_shared,30064771072,14680064,29360128,4194304,30064771072,623.304347826087,30.38687191429149
up_shared,30064771072,14680064,29360128,4194304,30064771072,623.304347826087,30.38687191429149
silu_shared,14680064,4194304,,4194304,14680064,1.75,2.502568019093079
down_shared,30064771072,4194304,29360128,14680064,30064771072,623.304347826087,30.38687191429149
router,3758096384,14680064,3670016,524288,3758096384,199.11111111111111,5.6307780429594265
gate_routed,939524096,458752,29360128,131072,939524096,31.36980306345733,8.934949880668258
up_routed,939524096,458752,29360128,131072,939524096,31.36980306345733,8.934949880668258
silu_routed,458752,131072,,131072,458752,1.75,0.07820525059665871
down_routed,939524096,131072,29360128,458752,939524096,31.36980306345733,8.934949880668258
residual_addition2,7340032,14680064,,14680064,7340032,0.25,8.758988066825776
Total FLOPS,"FLOPS    773107548160
FLOPS    773107548160
dtype: int64",,,,,,
