Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time
pre_attn_norm,7516192768,3758096384,,3758096384,7516192768,1.0,2242.3009451073985
query_down,5772436045824,3758096384,22020096,805306368,5772436045824,1258.8666819117311,5834.279407543966
k_rope_w,240518168576,3758096384,917504,33554432,240518168576,63.41828235700709,1131.43446300716
kv_down,1924145348608,3758096384,7340032,268435456,1924145348608,476.9971406290616,1944.7598025146553
norm_for_compressed_q,1610612736,805306368,,805306368,1610612736,1.0,480.49305966587116
norm_for_compressed_kv,536870912,268435456,,268435456,536870912,1.0,160.16435322195704
q_rope_w,6597069766656,805306368,25165824,4294967296,6597069766656,1287.1227495908347,6667.747894335961
query_up,13194139533312,805306368,50331648,8589934592,13194139533312,1396.8596802841919,13335.495788671922
transposed (k up proj),4398046511104,8589934592,16777216,34359738368,4398046511104,102.36001561889887,12818.15339379475
q_rope,12884901888,4294967296,,4294967296,12884901888,1.5,2562.6296515513127
k_rope,100663296,33554432,,33554432,100663296,1.5,20.02054415274463
score layer for RoPE,4398046511104,4294967296,33554432,68719476736,4398046511104,60.2076251722554,21792.36231026253
score layer for NoPE,35184372088832,34359738368,268435456,68719476736,35184372088832,340.44675324675325,35561.32210312513
mask_scale_softmax,240518168576,68719476736,,68719476736,240518168576,1.75,41002.074424821
context_matmul,35184372088832,68719476736,268435456,34359738368,35184372088832,340.44675324675325,35561.32210312513
v_up_proj_context,4398046511104,34359738368,16777216,8589934592,4398046511104,102.36001561889887,12818.15339379475
out_proj_context,61572651155456,8589934592,234881024,3758096384,61572651155456,4893.354666666667,62232.31368046897
residual_addition,1879048192,3758096384,,3758096384,1879048192,0.25,2242.3009451073985
post_attn_norm,7516192768,3758096384,,3758096384,7516192768,1.0,2242.3009451073985
gate_shared,7696581394432,3758096384,29360128,1073741824,7696581394432,1583.2683347713546,7779.039210058621
up_shared,7696581394432,3758096384,29360128,1073741824,7696581394432,1583.2683347713546,7779.039210058621
silu_shared,3758096384,1073741824,,1073741824,3758096384,1.75,640.6574128878282
down_shared,7696581394432,1073741824,29360128,3758096384,7696581394432,1583.2683347713546,7779.039210058621
router,962072674304,3758096384,3670016,134217728,962072674304,246.93957744583503,1162.2864343675417
gate_routed,240518168576,117440512,29360128,33554432,240518168576,1333.5813953488373,243.09497531433192
up_routed,240518168576,117440512,29360128,33554432,240518168576,1333.5813953488373,243.09497531433192
silu_routed,117440512,33554432,,33554432,117440512,1.75,20.02054415274463
down_routed,240518168576,33554432,29360128,117440512,240518168576,1333.5813953488373,243.09497531433192
residual_addition2,1879048192,3758096384,,3758096384,1879048192,0.25,2242.3009451073985
Total FLOPS,"FLOPS    197915532328960
FLOPS    197915532328960
dtype: int64",,,,,,
