Layer Name,FLOPS,InputA,InputB,Output
pre_attn_norm,29360128,"1024,7168,1",,"1024,7168,1"
query_down,22548578304,"1024,7168,1","7168,1536,1","1024,1536,1"
attn_norm_1,6291456,"1024,1536,1",,"1024,1536,1"
query_up,51539607552,"1024,1536,1","1536,16384,1","1024,24576,1"
kv_down,7516192768,"1024,7168,1","7168,512,1","1024,512,1"
attn_norm_2,2097152,"1024,512,1",,"1024,512,1"
k_up,17179869184,"1024,512,1","512,16384,1","1024,24576,1"
v_up,17179869184,"1024,512,1","512,16384,1","1024,16384,1"
k_rope_w,939524096,"1024,7168,1","7168,64,1","1024,64,1"
q_rope_w,25769803776,"1024,1536,1","1536,8192,1","1024,8192,1"
k_rope,393216,"1024,64,1",,"1024,64,1"
q_rope,50331648,"1024,8192,1",,"1024,8192,1"
score,51539607552,"1024,24576,1","1024,24576,1","1024,1024,128"
mask_scale_softmax,939524096,"1024,1024,128",,"1024,1024,128"
context_head,34359738368,"1024,1024,128","1024,16384,1","1024,16384,1"
out_proj,240518168576,"1024,16384,1","16384,7168,1","1024,7168,1"
residual_addition,7340032,"1024,7168,1",,"1024,7168,1"
post_attn_norm,29360128,"1024,7168,1",,"32,7168,1"
gate_shared,30064771072,"32,7168,1","7168,2048,1","1024,2048,1"
up_shared,30064771072,"32,7168,1","7168,2048,1","1024,2048,1"
silu_shared,14680064,"1024,2048,1",,"1024,2048,1"
down_shared,30064771072,"1024,2048,1","2048,7168,1","1024,7168,1"
router,3758096384,"32,7168,1","7168,256,1","1024,256,1"
gate_routed,939524096,"32,7168,1","7168,2048,1","32,2048,1"
up_routed,939524096,"32,7168,1","7168,2048,1","32,2048,1"
silu_routed,458752,"32,2048,1",,"32,2048,1"
down_routed,939524096,"32,2048,1","2048,7168,1","32,7168,1"
residual_addition2,7340032,"1024,7168,1",,"1024,7168,1"
Total FLOPS,566949117952,,,
