Layer Name,FLOPS,InputA,InputB,Output,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,3670016,1835008,,1835008,1.0,1.094873508353222,0.75
query_down,2818572288,1835008,22020096,393216,116.23783783783784,7.233985680190931,4.98
attn_norm_1,786432,393216,,393216,1.0,0.23461575178997615,0.16
query_up,3221225472,393216,25165824,2097152,116.4739336492891,8.250653937947494,5.68
kv_down,939524096,1835008,7340032,131072,100.95774647887323,2.776286396181384,1.91
attn_norm_2,262144,131072,,131072,1.0,0.07820525059665871,0.05
k_up,1073741824,131072,8388608,2097152,101.1358024691358,3.1673126491646775,2.18
v_up,1073741824,131072,8388608,2097152,101.1358024691358,3.1673126491646775,2.18
k_rope_w,117440512,1835008,917504,16384,42.414201183431956,0.8260429594272076,0.57
q_rope_w,1610612736,393216,12582912,1048576,114.8411214953271,4.18398090692124,2.88
k_rope,49152,16384,,16384,1.5,0.009775656324582339,0.01
q_rope,3145728,1048576,,1048576,1.5,0.6256420047732697,0.43
flash_attention,6422672,3145728,50380800,3145728,0.0004977339359294412,16.906997613365153,11.65
out_proj,22548585472,3145728,117440512,1835008,184.1884953827623,36.521852028639614,25.16
residual_addition,917504,1835008,,1835008,0.25,1.094873508353222,0.75
post_attn_norm,3670016,1835008,,1835008,1.0,1.094873508353222,0.75
gate_shared,3758096384,1835008,29360128,524288,118.47933884297521,9.462835322195705,6.52
up_shared,3758096384,1835008,29360128,524288,118.47933884297521,9.462835322195705,6.52
silu_shared,1835008,524288,,524288,1.75,0.31282100238663485,0.22
down_shared,3758096384,524288,29360128,1835008,118.47933884297521,9.462835322195705,6.52
router,469762048,1835008,3670016,65536,84.32941176470588,1.6618615751789976,1.14
gate_routed,234881024,114688,29360128,32768,7.960022209883398,8.802978520286397,6.06
up_routed,234881024,114688,29360128,32768,7.960022209883398,8.802978520286397,6.06
silu_routed,114688,32768,,32768,1.75,0.019551312649164678,0.01
down_routed,234881024,32768,29360128,114688,7.960022209883398,8.802978520286397,6.06
residual_addition2,917504,1835008,,1835008,0.25,1.094873508353222,0.75
Total FLOPS,45873929360,,,,,,
