Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time
pre_attn_norm,28672,14336,,14336,28672,1.0,0.008553699284009546
query_down,22020096,14336,22020096,3072,22020096,0.9992100738813252,6.574434367541766
k_rope_w,917504,14336,917504,128,917504,0.9844801538250241,0.2780334128878281
kv_down,7340032,14336,7340032,1024,7340032,0.9979117360434359,2.1943293556085917
norm_for_compressed_q,6144,3072,,3072,6144,1.0,0.0018329355608591887
norm_for_compressed_kv,2048,1024,,1024,2048,1.0,0.0006109785202863962
q_rope_w,25165824,3072,25165824,16384,25165824,0.999227485261232,7.513508353221957
query_up,50331648,3072,50331648,32768,50331648,0.999288429869681,15.026100238663485
transposed (k up proj),16777216,32768,16777216,131072,16777216,0.9903288201160542,5.0540143198090695
q_rope,49152,16384,,16384,49152,1.5,0.009775656324582339
k_rope,384,128,,128,384,1.5,7.637231503579952e-05
score layer for RoPE,16793600,16384,131200,262400,16793600,40.961598501404936,0.12231026252983294
score layer for NoPE,134348800,131072,1049600,262400,134348800,93.09916622316835,0.43051073985680194
mask_scale_softmax,918400,262400,,262400,918400,1.75,0.156563245823389
context_matmul,134348800,262400,1049600,131072,134348800,93.09916622316835,0.43051073985680194
v_up_proj_context,16777216,131072,16777216,32768,16777216,0.9903288201160542,5.0540143198090695
out_proj_context,234881024,32768,234881024,14336,234881024,0.9997994961250447,70.08595704057278
residual_addition,7168,14336,,14336,7168,0.25,0.008553699284009546
post_attn_norm,28672,14336,,14336,28672,1.0,0.008553699284009546
gate_shared,29360128,14336,29360128,4096,29360128,0.9993726036946672,8.764486873508353
up_shared,29360128,14336,29360128,4096,29360128,0.9993726036946672,8.764486873508353
silu_shared,14336,4096,,4096,14336,1.75,0.0024439140811455848
down_shared,29360128,4096,29360128,14336,29360128,0.9993726036946672,8.764486873508353
router,3670016,14336,3670016,512,3670016,0.995970543281923,1.0993031026252984
gate_routed,29360128,14336,29360128,4096,29360128,0.9993726036946672,8.764486873508353
up_routed,29360128,14336,29360128,4096,29360128,0.9993726036946672,8.764486873508353
silu_routed,14336,4096,,4096,14336,1.75,0.0024439140811455848
down_routed,29360128,4096,29360128,14336,29360128,0.9993726036946672,8.764486873508353
residual_addition2,7168,14336,,14336,7168,0.25,0.008553699284009546
Total FLOPS,"FLOPS    840609024
FLOPS    840609024
dtype: int64",,,,,,
