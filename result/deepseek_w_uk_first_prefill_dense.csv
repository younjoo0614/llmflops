Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time
pre_attn_norm,7516192768,3758096384,,3758096384,7516192768,1.0,2242.3009451073985
query_down,5772436045824,3758096384,22020096,805306368,5772436045824,1258.8666819117311,5834279407543966.0
k_rope_w,240518168576,3758096384,917504,33554432,240518168576,63.41828235700709,1131.43446300716
kv_down,1924145348608,3758096384,7340032,268435456,1924145348608,476.9971406290616,1944759802514655.5
norm_for_compressed_q,1610612736,805306368,,805306368,1610612736,1.0,480.49305966587116
norm_for_compressed_kv,536870912,268435456,,268435456,536870912,1.0,160.16435322195704
q_rope_w,6597069766656,805306368,25165824,4294967296,6597069766656,1287.1227495908347,6667747894335961.0
query_up,13194139533312,805306368,50331648,8589934592,13194139533312,1396.8596802841919,1.3335495788671922e+16
transposed (k up proj),4398046511104,8589934592,16777216,34359738368,4398046511104,102.36001561889887,12818.15339379475
q_rope,12884901888,4294967296,,4294967296,12884901888,1.5,2562.6296515513127
k_rope,100663296,33554432,,33554432,100663296,1.5,20.02054415274463
score layer for RoPE,4398046511104,4294967296,33554432,68719476736,4398046511104,60.2076251722554,21792.36231026253
score layer for NoPE,35184372088832,34359738368,268435456,68719476736,35184372088832,340.44675324675325,3.556132210312513e+16
mask_scale_softmax,240518168576,68719476736,,68719476736,240518168576,1.75,41002.074424821
context_matmul,35184372088832,68719476736,268435456,34359738368,35184372088832,340.44675324675325,3.556132210312513e+16
v_up_proj_context,4398046511104,34359738368,16777216,8589934592,4398046511104,102.36001561889887,12818.15339379475
out_proj_context,61572651155456,8589934592,234881024,3758096384,61572651155456,4893.354666666667,6.223231368046898e+16
residual_addition,1879048192,3758096384,,3758096384,1879048192,0.25,2242.3009451073985
post_attn_norm,7516192768,3758096384,,3758096384,7516192768,1.0,2242.3009451073985
gate_proj,69269232549888,3758096384,264241152,9663676416,69269232549888,5061.31535396874,7.001135289052759e+16
up_proj,69269232549888,3758096384,264241152,9663676416,69269232549888,5061.31535396874,7.001135289052759e+16
silu,33822867456,9663676416,,9663676416,33822867456,1.75,5765.916715990453
down_proj,69269232549888,9663676416,264241152,3758096384,69269232549888,5061.31535396874,7.001135289052759e+16
residual_addition2,1879048192,3758096384,,3758096384,1879048192,0.25,2242.3009451073985
Total FLOPS,"FLOPS    380979805945856
FLOPS    380979805945856
dtype: int64",,,,,,
