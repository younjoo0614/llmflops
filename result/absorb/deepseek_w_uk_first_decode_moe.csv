Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,58720256,29360128,,29360128,58720256,1.0,17.51797613365155,0.49
query_down,45097156608,29360128,22020096,6291456,45097156608,781.9636363636364,45.580307871437235,1.27
k_rope_w,1879048192,29360128,917504,262144,1879048192,61.527896995708154,9.11091169451074,0.25
kv_down,15032385536,29360128,7340032,2097152,15032385536,387.4594594594595,15.193435957145745,0.42
norm_for_compressed_q,12582912,6291456,,6291456,12582912,1.0,3.7538520286396184,0.1
norm_for_compressed_kv,4194304,2097152,,2097152,4194304,1.0,1.2512840095465394,0.03
q_rope_w,51539607552,6291456,25165824,33554432,51539607552,792.7741935483871,52.091780424499696,1.46
query_up,103079215104,6291456,50331648,67108864,103079215104,833.0847457627119,104.18356084899939,2.91
transposed (k up proj),34359738368,67108864,16777216,268435456,34359738368,97.52380952380952,105.1078568019093,2.94
q_rope,100663296,33554432,,33554432,100663296,1.5,20.02054415274463,0.56
k_rope,786432,262144,,262144,786432,1.5,0.15641050119331742,0.0
score layer for RoPE,34393292800,33554432,268697600,537395200,34393292800,40.961598501404936,250.49141766109787,7.0
score layer for NoPE,275146342400,268435456,2149580800,537395200,275146342400,93.09916622316835,881.6859952267304,24.65
mask_scale_softmax,1880883200,537395200,,537395200,1880883200,1.75,320.6415274463007,8.96
context_matmul,275146342400,537395200,2149580800,268435456,275146342400,93.09916622316835,881.6859952267304,24.65
v_up_proj_context,34359738368,268435456,16777216,67108864,34359738368,97.52380952380952,105.1078568019093,2.94
out_proj_context,481036337152,67108864,234881024,29360128,481036337152,1451.746835443038,486.18995062866384,13.59
residual_addition,14680064,29360128,,29360128,14680064,0.25,17.51797613365155,0.49
post_attn_norm,58720256,29360128,,29360128,58720256,1.0,17.51797613365155,0.49
gate_shared,60129542144,29360128,29360128,8388608,60129542144,896.0,60.77374382858298,1.7
up_shared,60129542144,29360128,29360128,8388608,60129542144,896.0,60.77374382858298,1.7
silu_shared,29360128,8388608,,8388608,29360128,1.75,5.005136038186158,0.14
down_shared,60129542144,8388608,29360128,29360128,60129542144,896.0,60.77374382858298,1.7
router,7516192768,29360128,3670016,1048576,7516192768,220.55384615384617,10.166682577565632,0.28
gate_routed,1879048192,917504,29360128,262144,1879048192,61.527896995708154,9.11091169451074,0.25
up_routed,1879048192,917504,29360128,262144,1879048192,61.527896995708154,9.11091169451074,0.25
silu_routed,917504,262144,,262144,917504,1.75,0.15641050119331742,0.0
down_routed,1879048192,262144,29360128,917504,1879048192,61.527896995708154,9.11091169451074,0.25
residual_addition2,14680064,29360128,,29360128,14680064,0.25,17.51797613365155,0.49
Total FLOPS,"FLOPS    1546787356672
FLOPS    1546787356672
dtype: int64",,,,,,,
