Layer Name,FLOPS,InputA,InputB,Output,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,3670016,1835008,,1835008,1.0,1.094873508353222,0.44
query_down,2818572288,1835008,22020096,393216,116.23783783783784,7.233985680190931,2.91
k_rope_w,117440512,1835008,917504,16384,42.414201183431956,0.8260429594272076,0.33
kv_down,939524096,1835008,7340032,131072,100.95774647887323,2.776286396181384,1.12
norm_for_compressed_q,786432,393216,,393216,1.0,0.23461575178997615,0.09
norm_for_compressed_kv,262144,131072,,131072,1.0,0.07820525059665871,0.03
q_rope_w,1610612736,393216,12582912,1048576,114.8411214953271,4.18398090692124,1.68
query_up,3221225472,393216,25165824,2097152,116.4739336492891,8.250653937947494,3.32
transposed (k up proj),1073741824,2097152,8388608,8388608,56.888888888888886,5.6307780429594265,2.27
q_rope,3145728,1048576,,1048576,1.5,0.6256420047732697,0.25
k_rope,49152,16384,,16384,1.5,0.009775656324582339,0.0
score layer for RoPE,1074790400,1048576,16793600,16793600,31.031220435193944,10.332868735083531,4.16
score layer for NoPE,8598323200,8388608,134348800,16793600,53.89750436479409,47.59278281622912,19.16
mask_scale_softmax,58777600,16793600,,16793600,1.75,10.020047732696897,4.03
context_matmul,8598323200,16793600,134348800,8388608,53.89750436479409,47.59278281622912,19.16
v_up_proj_context,1073741824,8388608,8388608,2097152,56.888888888888886,5.6307780429594265,2.27
out_proj,15032844288,2097152,117440512,1835008,123.85691144708423,36.20903102625298,14.58
residual_addition,917504,1835008,,1835008,0.25,1.094873508353222,0.44
post_attn_norm,3670016,1835008,,1835008,1.0,1.094873508353222,0.44
gate_shared,3758096384,1835008,29360128,524288,118.47933884297521,9.462835322195705,3.81
up_shared,3758096384,1835008,29360128,524288,118.47933884297521,9.462835322195705,3.81
silu_shared,1835008,524288,,524288,1.75,0.31282100238663485,0.13
down_shared,3758096384,524288,29360128,1835008,118.47933884297521,9.462835322195705,3.81
router,469762048,1835008,3670016,65536,84.32941176470588,1.6618615751789976,0.67
gate_routed,234881024,114688,29360128,32768,7.960022209883398,8.802978520286397,3.54
up_routed,234881024,114688,29360128,32768,7.960022209883398,8.802978520286397,3.54
silu_routed,114688,32768,,32768,1.75,0.019551312649164678,0.01
down_routed,234881024,32768,29360128,114688,7.960022209883398,8.802978520286397,3.54
residual_addition2,917504,1835008,,1835008,0.25,1.094873508353222,0.44
Total FLOPS,56681979904,,,,,,
