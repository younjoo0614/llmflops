Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,7340032,3670016,,3670016,7340032,1.0,2.189747016706444,0.31
query_down,5637144576,3670016,22020096,786432,5637144576,212.9108910891089,7.89873031026253,1.12
k_rope_w,234881024,3670016,917504,32768,234881024,50.836879432624116,1.3783675417661096,0.2
kv_down,1879048192,3670016,7340032,262144,1879048192,166.69767441860466,3.3628257756563245,0.48
norm_for_compressed_q,1572864,786432,,786432,1572864,1.0,0.4692315035799523,0.07
norm_for_compressed_kv,524288,262144,,262144,524288,1.0,0.15641050119331742,0.02
q_rope_w,6442450944,786432,25165824,4194304,6442450944,213.70434782608694,8.993603818615751,1.27
query_up,12884901888,786432,50331648,8388608,12884901888,216.5286343612335,17.75259188544153,2.52
transposed (k up proj),4294967296,8388608,16777216,33554432,4294967296,73.14285714285714,17.51797613365155,2.48
q_rope,12582912,4194304,,4194304,12582912,1.5,2.502568019093079,0.35
k_rope,98304,32768,,32768,98304,1.5,0.019551312649164678,0.0
score layer for RoPE,4299161600,4194304,33587200,67174400,4299161600,40.961598501404936,31.311427207637234,4.44
score layer for NoPE,34393292800,33554432,268697600,67174400,34393292800,93.09916622316835,110.2107494033413,15.62
mask_scale_softmax,235110400,67174400,,67174400,235110400,1.75,40.08019093078759,5.68
context_matmul,34393292800,67174400,268697600,33554432,34393292800,93.09916622316835,110.2107494033413,15.62
v_up_proj_context,4294967296,33554432,16777216,8388608,4294967296,73.14285714285714,17.51797613365155,2.48
out_proj_context,60129542144,8388608,234881024,3670016,60129542144,243.49893842887474,73.6693460620525,10.44
residual_addition,1835008,3670016,,3670016,1835008,0.25,2.189747016706444,0.31
post_attn_norm,7340032,3670016,,3670016,7340032,1.0,2.189747016706444,0.31
gate_proj,67645734912,3670016,264241152,9437184,67645734912,243.90170132325142,82.7411551312649,11.73
up_proj,67645734912,3670016,264241152,9437184,67645734912,243.90170132325142,82.7411551312649,11.73
silu,33030144,9437184,,9437184,33030144,1.75,5.6307780429594265,0.8
down_proj,67645734912,9437184,264241152,3670016,67645734912,243.90170132325142,82.7411551312649,11.73
residual_addition2,1835008,3670016,,3670016,1835008,0.25,2.189747016706444,0.31
Total FLOPS,"FLOPS    372122124288
FLOPS    372122124288
dtype: int64",,,,,,,
