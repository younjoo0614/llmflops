Layer Name,FLOPS,InputA,InputB,Output,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,3670016,1835008,,1835008,1.0,1.094873508353222,0.35
query_down,2818572288,1835008,22020096,393216,116.23783783783784,7.233985680190931,2.3
k_rope_w,117440512,1835008,917504,16384,42.414201183431956,0.8260429594272076,0.26
kv_down,939524096,1835008,7340032,131072,100.95774647887323,2.776286396181384,0.88
norm_for_compressed_q,786432,393216,,393216,1.0,0.23461575178997615,0.07
norm_for_compressed_kv,262144,131072,,131072,1.0,0.07820525059665871,0.02
q_rope_w,1610612736,393216,12582912,1048576,114.8411214953271,4.18398090692124,1.33
query_up,3221225472,393216,25165824,2097152,116.4739336492891,8.250653937947494,2.62
transposed (k up proj),1073741824,2097152,8388608,8388608,56.888888888888886,5.6307780429594265,1.79
q_rope,3145728,1048576,,1048576,1.5,0.6256420047732697,0.2
k_rope,49152,16384,,16384,1.5,0.009775656324582339,0.0
score layer for RoPE,1074790400,1048576,16793600,16793600,31.031220435193944,10.332868735083531,3.28
score layer for NoPE,8598323200,8388608,134348800,16793600,53.89750436479409,47.59278281622912,15.11
mask_scale_softmax,58777600,16793600,,16793600,1.75,10.020047732696897,3.18
context_matmul,8598323200,16793600,134348800,8388608,53.89750436479409,47.59278281622912,15.11
v_up_proj_context,1073741824,8388608,8388608,2097152,56.888888888888886,5.6307780429594265,1.79
out_proj,15032844288,2097152,117440512,1835008,123.85691144708423,36.20903102625298,11.49
residual_addition,917504,1835008,,1835008,0.25,1.094873508353222,0.35
post_attn_norm,3670016,1835008,,1835008,1.0,1.094873508353222,0.35
gate_proj,16911433728,1835008,132120576,2359296,124.06153846153846,40.66673031026253,12.91
up_proj,16911433728,1835008,132120576,2359296,124.06153846153846,40.66673031026253,12.91
silu,8257536,2359296,,2359296,1.75,1.4076945107398566,0.45
down_proj,16911433728,2359296,132120576,1835008,124.06153846153846,40.66673031026253,12.91
residual_addition2,917504,1835008,,1835008,0.25,1.094873508353222,0.35
Total FLOPS,94973894656,,,,,,
