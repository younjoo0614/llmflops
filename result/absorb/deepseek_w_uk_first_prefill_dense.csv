Layer Name,FLOPS,InputA,InputB,Output,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,3758096384,1879048192,,1879048192,1.0,1121.1504725536993,0.9
query_down,2886218022912,1879048192,22020096,402653184,1252.8502503413747,2917.139703771983,2.35
k_rope_w,120259084288,1879048192,917504,16777216,63.40294381867183,565.8540906921241,0.46
kv_down,962072674304,1879048192,7340032,134217728,476.13077322262586,972.3799012573277,0.78
norm_for_compressed_q,805306368,402653184,,402653184,1.0,240.24652983293558,0.19
norm_for_compressed_kv,268435456,134217728,,134217728,1.0,80.08217661097852,0.06
q_rope_w,1649267441664,402653184,12582912,1073741824,1107.650704225352,1666.9369735839903,1.34
query_up,3298534883328,402653184,25165824,2147483648,1280.8338762214983,3333.8739471679805,2.68
transposed (k up proj),1099511627776,2147483648,8388608,8589934592,102.32006245120999,3205.789632458234,2.58
q_rope,3221225472,1073741824,,1073741824,1.5,640.6574128878282,0.52
k_rope,50331648,16777216,,16777216,1.5,10.010272076372315,0.01
score layer for RoPE,1099511627776,1073741824,16777216,17179869184,60.17998163452709,5450.593145584726,4.38
score layer for NoPE,8796093022208,8589934592,134217728,17179869184,339.56476683937825,8890.330525781283,7.15
mask_scale_softmax,60129542144,17179869184,,17179869184,1.75,10250.51860620525,8.25
context_matmul,8796093022208,17179869184,134217728,8589934592,339.56476683937825,8890.330525781283,7.15
v_up_proj_context,1099511627776,8589934592,8388608,2147483648,102.32006245120999,3205.789632458234,2.58
out_proj,15393170128896,2147483648,117440512,1879048192,3714.5928643724696,15558.085838787143,12.52
residual_addition,939524096,1879048192,,1879048192,0.25,1121.1504725536993,0.9
post_attn_norm,3758096384,1879048192,,1879048192,1.0,1121.1504725536993,0.9
gate_proj,17317308137472,1879048192,132120576,2415919104,3911.67029843676,17502.838222631897,14.08
up_proj,17317308137472,1879048192,132120576,2415919104,3911.67029843676,17502.838222631897,14.08
silu,8455716864,2415919104,,2415919104,1.75,1441.4791789976132,1.16
down_proj,17317308137472,2415919104,132120576,1879048192,3911.67029843676,17502.838222631897,14.08
residual_addition2,939524096,1879048192,,1879048192,0.25,1121.1504725536993,0.9
Total FLOPS,97234493374464,,,,,,
