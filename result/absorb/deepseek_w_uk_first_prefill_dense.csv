Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,7516192768,3758096384,,3758096384,7516192768,1.0,2242.3009451073985,0.47
query_down,5772436045824,3758096384,22020096,805306368,5772436045824,1258.8666819117311,5834.279407543966,1.22
k_rope_w,240518168576,3758096384,917504,33554432,240518168576,63.41828235700709,1131.43446300716,0.24
kv_down,1924145348608,3758096384,7340032,268435456,1924145348608,476.9971406290616,1944.7598025146553,0.41
norm_for_compressed_q,1610612736,805306368,,805306368,1610612736,1.0,480.49305966587116,0.1
norm_for_compressed_kv,536870912,268435456,,268435456,536870912,1.0,160.16435322195704,0.03
q_rope_w,6597069766656,805306368,25165824,4294967296,6597069766656,1287.1227495908347,6667.747894335961,1.39
query_up,13194139533312,805306368,50331648,8589934592,13194139533312,1396.8596802841919,13335.495788671922,2.79
transposed (k up proj),4398046511104,8589934592,16777216,34359738368,4398046511104,102.36001561889887,12818.15339379475,2.68
q_rope,12884901888,4294967296,,4294967296,12884901888,1.5,2562.6296515513127,0.54
k_rope,100663296,33554432,,33554432,100663296,1.5,20.02054415274463,0.0
score layer for RoPE,4398046511104,4294967296,33554432,68719476736,4398046511104,60.2076251722554,21792.36231026253,4.55
score layer for NoPE,35184372088832,34359738368,268435456,68719476736,35184372088832,340.44675324675325,35561.32210312513,7.43
mask_scale_softmax,240518168576,68719476736,,68719476736,240518168576,1.75,41002.074424821,8.57
context_matmul,35184372088832,68719476736,268435456,34359738368,35184372088832,340.44675324675325,35561.32210312513,7.43
v_up_proj_context,4398046511104,34359738368,16777216,8589934592,4398046511104,102.36001561889887,12818.15339379475,2.68
out_proj_context,61572651155456,8589934592,234881024,3758096384,61572651155456,4893.354666666667,62232.31368046897,13.0
residual_addition,1879048192,3758096384,,3758096384,1879048192,0.25,2242.3009451073985,0.47
post_attn_norm,7516192768,3758096384,,3758096384,7516192768,1.0,2242.3009451073985,0.47
gate_proj,69269232549888,3758096384,264241152,9663676416,69269232549888,5061.31535396874,70011.35289052759,14.63
up_proj,69269232549888,3758096384,264241152,9663676416,69269232549888,5061.31535396874,70011.35289052759,14.63
silu,33822867456,9663676416,,9663676416,33822867456,1.75,5765.916715990453,1.2
down_proj,69269232549888,9663676416,264241152,3758096384,69269232549888,5061.31535396874,70011.35289052759,14.63
residual_addition2,1879048192,3758096384,,3758096384,1879048192,0.25,2242.3009451073985,0.47
Total FLOPS,"FLOPS    380979805945856
FLOPS    380979805945856
dtype: int64",,,,,,,
