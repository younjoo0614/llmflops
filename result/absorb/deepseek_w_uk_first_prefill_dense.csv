Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,60129542144,30064771072,,30064771072,60129542144,1.0,17938.40756085919,0.47
query_down,46179488366592,30064771072,22020096,6442450944,46179488366592,1264.1786606194564,46674.23526035173,1.22
k_rope_w,1924145348608,30064771072,917504,268435456,1924145348608,63.431709667244235,9049.559675417662,0.24
kv_down,15393162788864,30064771072,7340032,2147483648,15393162788864,477.7578025840466,15558.078420117243,0.41
norm_for_compressed_q,12884901888,6442450944,,6442450944,12884901888,1.0,3843.9444773269693,0.1
norm_for_compressed_kv,4294967296,2147483648,,2147483648,4294967296,1.0,1281.3148257756563,0.03
q_rope_w,52776558133248,6442450944,25165824,34359738368,52776558133248,1292.6763920279434,53341.98315468769,1.39
query_up,105553116266496,6442450944,50331648,68719476736,105553116266496,1403.403078295784,106683.96630937538,2.79
transposed (k up proj),35184372088832,68719476736,16777216,274877906944,35184372088832,102.39500024412871,102510.19119809069,2.68
q_rope,103079215104,34359738368,,34359738368,103079215104,1.5,20501.0372124105,0.54
k_rope,805306368,268435456,,268435456,805306368,1.5,160.16435322195704,0.0
score layer for RoPE,35184372088832,34359738368,268435456,549755813888,35184372088832,60.2076251722554,174338.89848210025,4.55
score layer for NoPE,281474976710656,274877906944,2147483648,549755813888,281474976710656,340.44675324675325,284490.57682500104,7.43
mask_scale_softmax,1924145348608,549755813888,,549755813888,1924145348608,1.75,328016.595398568,8.57
context_matmul,281474976710656,549755813888,2147483648,274877906944,281474976710656,340.44675324675325,284490.57682500104,7.43
v_up_proj_context,35184372088832,274877906944,16777216,68719476736,35184372088832,102.39500024412871,102510.19119809069,2.68
out_proj_context,492581209243648,68719476736,234881024,30064771072,492581209243648,4974.6065740426975,497858.50944375177,13.0
residual_addition,15032385536,30064771072,,30064771072,15032385536,0.25,17938.40756085919,0.47
post_attn_norm,60129542144,30064771072,,30064771072,60129542144,1.0,17938.40756085919,0.47
gate_proj,554153860399104,30064771072,264241152,77309411328,554153860399104,5148.290379145073,560090.8231242207,14.63
up_proj,554153860399104,30064771072,264241152,77309411328,554153860399104,5148.290379145073,560090.8231242207,14.63
silu,270582939648,77309411328,,77309411328,270582939648,1.75,46127.33372792362,1.2
down_proj,554153860399104,77309411328,264241152,30064771072,554153860399104,5148.290379145073,560090.8231242207,14.63
residual_addition2,15032385536,30064771072,,30064771072,15032385536,0.25,17938.40756085919,0.47
Total FLOPS,"FLOPS    3047838447566848
FLOPS    3047838447566848
dtype: int64",,,,,,,
