Layer Name,FLOPS,InputA,InputB,Output,FLOPS,OP/B,Execution_time,Execution_time(%)
pre_attn_norm,60129542144,30064771072,,30064771072,60129542144,1.0,17938.40756085919,0.78
query_down,46179488366592,30064771072,22020096,6442450944,46179488366592,1264.1786606194564,46674.23526035173,2.02
k_rope_w,1924145348608,30064771072,917504,268435456,1924145348608,63.431709667244235,9049.559675417662,0.39
kv_down,15393162788864,30064771072,7340032,2147483648,15393162788864,477.7578025840466,15558.078420117243,0.67
norm_for_compressed_q,12884901888,6442450944,,6442450944,12884901888,1.0,3843.9444773269693,0.17
norm_for_compressed_kv,4294967296,2147483648,,2147483648,4294967296,1.0,1281.3148257756563,0.06
q_rope_w,52776558133248,6442450944,25165824,34359738368,52776558133248,1292.6763920279434,53341.98315468769,2.31
query_up,105553116266496,6442450944,50331648,68719476736,105553116266496,1403.403078295784,106683.96630937538,4.62
transposed (k up proj),35184372088832,68719476736,16777216,274877906944,35184372088832,102.39500024412871,102510.19119809069,4.44
q_rope,103079215104,34359738368,,34359738368,103079215104,1.5,20501.0372124105,0.89
k_rope,805306368,268435456,,268435456,805306368,1.5,160.16435322195704,0.01
score layer for RoPE,35184372088832,34359738368,268435456,549755813888,35184372088832,60.2076251722554,174338.89848210025,7.55
score layer for NoPE,281474976710656,274877906944,2147483648,549755813888,281474976710656,340.44675324675325,284490.57682500104,12.31
mask_scale_softmax,1924145348608,549755813888,,549755813888,1924145348608,1.75,328016.595398568,14.2
context_matmul,281474976710656,549755813888,2147483648,274877906944,281474976710656,340.44675324675325,284490.57682500104,12.31
v_up_proj_context,35184372088832,274877906944,16777216,68719476736,35184372088832,102.39500024412871,102510.19119809069,4.44
out_proj_context,492581209243648,68719476736,234881024,30064771072,492581209243648,4974.6065740426975,497858.50944375177,21.55
residual_addition,15032385536,30064771072,,30064771072,15032385536,0.25,17938.40756085919,0.78
post_attn_norm,60129542144,30064771072,,30064771072,60129542144,1.0,17938.40756085919,0.78
gate_shared,61572651155456,30064771072,29360128,8589934592,61572651155456,1591.6799306082619,62232.31368046897,2.69
up_shared,61572651155456,30064771072,29360128,8589934592,61572651155456,1591.6799306082619,62232.31368046897,2.69
silu_shared,30064771072,8589934592,,8589934592,30064771072,1.75,5125.259303102625,0.22
down_shared,61572651155456,8589934592,29360128,30064771072,61572651155456,1591.6799306082619,62232.31368046897,2.69
router,7696581394432,30064771072,3670016,1073741824,7696581394432,247.14328524049228,9290.627360381863,0.4
gate_routed,1924145348608,939524096,29360128,268435456,1924145348608,1555.0915254237289,1944.7598025146553,0.08
up_routed,1924145348608,939524096,29360128,268435456,1924145348608,1555.0915254237289,1944.7598025146553,0.08
silu_routed,939524096,268435456,,268435456,939524096,1.75,160.16435322195704,0.01
down_routed,1924145348608,268435456,29360128,939524096,1924145348608,1555.0915254237289,1944.7598025146553,0.08
residual_addition2,15032385536,30064771072,,30064771072,15032385536,0.25,17938.40756085919,0.78
Total FLOPS,"FLOPS    1583324258631680
FLOPS    1583324258631680
dtype: int64",,,,,,,
